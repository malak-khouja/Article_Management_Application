import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.scene.control.Alert;
import javafx.scene.control.Button;
import javafx.scene.control.TextField;
import javafx.scene.control.Alert.AlertType;
import javafx.stage.Stage;

import java.sql.Connection;
import java.sql.SQLException;

public class MainSceneController {

    @FXML
    private TextField T1; // CodeArticle

    @FXML
    private TextField T2; // Libelle

    @FXML
    private TextField T3; // Qte

    @FXML
    private TextField T4; // PrixHT

    @FXML
    private Button b;

    @FXML
    void btnSauvegarderClicked(ActionEvent event) {
        try {
            String codeArticle = T1.getText();
            String libelle = T2.getText();
            int qte = Integer.parseInt(T3.getText());
            double prixHT = Double.parseDouble(T4.getText());

            // Create an Article object
            Article article = new Article(codeArticle, libelle, qte, prixHT);

            // Use DatabaseConnection to get a connection
            Connection connection = DatabaseConnection.getConnection();

            // Create an ArticleDb instance
            ArticleDb articleDb = new ArticleDb(connection);

            // Add the article to the database
            articleDb.createArticle(article);

            // Display success message
            showAlert("Success", "Article added successfully!");

            // Clear text fields (optional)
            T1.setText("");
            T2.setText("");
            T3.setText("");
            T4.setText(""); 

        } catch (SQLException e) {
            showAlert("Error", "Failed to add article: " + e.getMessage());
        } catch (NumberFormatException e) {
            showAlert("Error", "Invalid input for quantity or price.");
        }
    }

    private void showAlert(String title, String message) {
        Alert alert = new Alert(AlertType.INFORMATION);
        alert.setTitle(title);
        alert.setHeaderText(null);
        alert.setContentText(message);
        alert.showAndWait();
    }
}